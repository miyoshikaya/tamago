{"ast":null,"code":"import _regeneratorRuntime from \"D:\\\\uni\\\\tamago\\\\ui\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"D:\\\\uni\\\\tamago\\\\ui\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"D:\\\\uni\\\\tamago\\\\ui\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\uni\\\\tamago\\\\ui\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"D:\\\\uni\\\\tamago\\\\ui\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"D:\\\\uni\\\\tamago\\\\ui\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"D:\\\\uni\\\\tamago\\\\ui\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"D:\\\\uni\\\\tamago\\\\ui\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"D:\\\\uni\\\\tamago\\\\ui\\\\src\\\\components\\\\HomePage\\\\PetSection\\\\PetCard\\\\CountdownTimers\\\\FoodTimer.js\";\nimport React from 'react';\nimport './countdowntimers.css';\nimport { firebase } from '../../../../../firebase';\nimport { db } from '../../../../../firebase';\n\nvar FoodTimer =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(FoodTimer, _React$Component);\n\n  function FoodTimer(props) {\n    var _this;\n\n    _classCallCheck(this, FoodTimer);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(FoodTimer).call(this, props));\n    _this.state = {\n      user: null,\n      time: {},\n      seconds: 15,\n      restart: false\n    };\n    _this.timer = 0;\n    _this.startTimer = _this.startTimer.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.countDown = _this.countDown.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.restartTimer = _this.restartTimer.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(FoodTimer, [{\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      clearInterval(this.timer);\n    }\n  }, {\n    key: \"secondsToTime\",\n    value: function secondsToTime(secs) {\n      var hours = Math.floor(secs / (60 * 60));\n      var divisor_for_minutes = secs % (60 * 60);\n      var minutes = Math.floor(divisor_for_minutes / 60);\n      var divisor_for_seconds = divisor_for_minutes % 60;\n      var seconds = Math.ceil(divisor_for_seconds);\n      var obj = {\n        \"h\": hours,\n        \"m\": minutes,\n        \"s\": seconds\n      };\n      return obj;\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var timeLeftVar = this.secondsToTime(this.state.seconds);\n      this.getUserData();\n      this.setState({\n        time: timeLeftVar\n      });\n      this.startTimer();\n    }\n  }, {\n    key: \"startTimer\",\n    value: function startTimer() {\n      if (this.timer === 0 && this.state.seconds > 0) {\n        this.setState({\n          seconds: this.state.seconds\n        });\n        this.timer = setInterval(this.countDown, 1000);\n      }\n    }\n  }, {\n    key: \"restartTimer\",\n    value: function restartTimer() {\n      this.setState({\n        restart: true\n      });\n    }\n  }, {\n    key: \"getUserData\",\n    value: function () {\n      var _getUserData = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var _this2 = this;\n\n        var user, userNew;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                user = db.onceGetUser(firebase.auth.currentUser.uid).then(function (snapshot) {\n                  return snapshot.val();\n                });\n                _context.next = 3;\n                return user.then(function (value) {\n                  _this2.setState({\n                    user: value\n                  });\n                });\n\n              case 3:\n                _context.next = 5;\n                return this.setNewFoodTimer();\n\n              case 5:\n                userNew = db.onceGetUser(firebase.auth.currentUser.uid).then(function (snapshot) {\n                  return snapshot.val();\n                });\n                _context.next = 8;\n                return userNew.then(function (value) {\n                  _this2.setState({\n                    user: value\n                  });\n                });\n\n              case 8:\n                _context.next = 10;\n                return this.setState({\n                  seconds: this.state.user.timers[1].timer\n                });\n\n              case 10:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function getUserData() {\n        return _getUserData.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"setNewFoodTimer\",\n    value: function () {\n      var _setNewFoodTimer = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        var timeStamp, newTimerFood, timestampFood, diffFood, newTimer;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                timeStamp = Math.floor(Date.now() / 1000);\n                newTimerFood = this.state.user.timers[1].timer;\n                timestampFood = this.state.user.timers[1].timestamp;\n                diffFood = timeStamp - timestampFood;\n                newTimer = Math.max(newTimerFood - diffFood, 1);\n                _context2.next = 7;\n                return db.setTimer(firebase.auth.currentUser.uid, newTimer, 1, \"food\", Math.floor(Date.now() / 1000));\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      return function setNewFoodTimer() {\n        return _setNewFoodTimer.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"setFoodTimer\",\n    value: function () {\n      var _setFoodTimer = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(seconds) {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return db.setTimer(firebase.auth.currentUser.uid, seconds, 1, \"food\", Math.floor(Date.now() / 1000));\n\n              case 2:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      return function setFoodTimer(_x) {\n        return _setFoodTimer.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"countDown\",\n    value: function countDown() {\n      if (this.props.restart) {\n        this.restartTimer(); //boom info back, zeby zmienic restart na false <---\n\n        this.props.pls();\n      }\n\n      if (!this.props.alive) {\n        console.log('pet died babe');\n        clearInterval(this.timer); //this.props.petDied('hunger');\n      }\n\n      if (!this.state.restart) {\n        // Remove one second, set state so a re-render happens.\n        var seconds = this.state.seconds - 1;\n        this.setState({\n          time: this.secondsToTime(seconds),\n          seconds: seconds\n        }); // Check if we're at zero.\n\n        if (seconds === 0) {\n          clearInterval(this.timer);\n          this.props.petDied('hunger'); //PET DEAD\n        }\n      } else {\n        var _seconds = 3599;\n        this.setState({\n          restart: false,\n          time: this.secondsToTime(_seconds),\n          seconds: _seconds\n        });\n        this.setFoodTimer(_seconds);\n      }\n    }\n  }, {\n    key: \"renderMinutesWithZero\",\n    value: function renderMinutesWithZero() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        className: \"timer wash-timer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, \"0\", this.state.time.m, \":\", this.state.time.s, this.props.restart));\n    }\n  }, {\n    key: \"renderSecondsWithZero\",\n    value: function renderSecondsWithZero() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        className: \"timer food-timer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, this.state.time.m, \":0\", this.state.time.s, this.props.restart));\n    }\n  }, {\n    key: \"renderBothWithZero\",\n    value: function renderBothWithZero() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        className: \"timer food-timer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, \"0\", this.state.time.m, \":0\", this.state.time.s, this.props.restart));\n    }\n  }, {\n    key: \"renderNormalTimer\",\n    value: function renderNormalTimer() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        className: \"timer food-timer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, this.state.time.m, \":\", this.state.time.s, this.props.restart));\n    }\n  }, {\n    key: \"renderOtherTimer\",\n    value: function renderOtherTimer() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }, this.state.time.m < 10 && this.state.time.s > 9 ? this.renderMinutesWithZero() : this.renderOtherOtherTimer());\n    }\n  }, {\n    key: \"renderOtherOtherTimer\",\n    value: function renderOtherOtherTimer() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, this.state.time.m > 9 && this.state.time.s < 10 ? this.renderSecondsWithZero() : this.renderNormalTimer());\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.state.time.h < 25) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 212\n          },\n          __self: this\n        }, this.state.time.m < 10 && this.state.time.s < 10 ? this.renderBothWithZero() : this.renderOtherTimer());\n      } else {\n        return null;\n      }\n    }\n  }]);\n\n  return FoodTimer;\n}(React.Component);\n\nexport default FoodTimer;","map":{"version":3,"sources":["D:\\uni\\tamago\\ui\\src\\components\\HomePage\\PetSection\\PetCard\\CountdownTimers\\FoodTimer.js"],"names":["React","firebase","db","FoodTimer","props","state","user","time","seconds","restart","timer","startTimer","bind","countDown","restartTimer","clearInterval","secs","hours","Math","floor","divisor_for_minutes","minutes","divisor_for_seconds","ceil","obj","timeLeftVar","secondsToTime","getUserData","setState","setInterval","onceGetUser","auth","currentUser","uid","then","snapshot","val","value","setNewFoodTimer","userNew","timers","timeStamp","Date","now","newTimerFood","timestampFood","timestamp","diffFood","newTimer","max","setTimer","pls","alive","console","log","petDied","setFoodTimer","m","s","renderMinutesWithZero","renderOtherOtherTimer","renderSecondsWithZero","renderNormalTimer","h","renderBothWithZero","renderOtherTimer","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport './countdowntimers.css';\r\nimport { firebase } from '../../../../../firebase';\r\nimport { db } from '../../../../../firebase';\r\n\r\nclass FoodTimer extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      user: null,\r\n      time: {},\r\n      seconds: 15,\r\n      restart: false,\r\n    };\r\n    this.timer = 0;\r\n    this.startTimer = this.startTimer.bind(this);\r\n    this.countDown = this.countDown.bind(this);\r\n    this.restartTimer = this.restartTimer.bind(this);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    clearInterval(this.timer);\r\n  }\r\n  secondsToTime(secs) {\r\n    let hours = Math.floor(secs / (60 * 60));\r\n\r\n    let divisor_for_minutes = secs % (60 * 60);\r\n    let minutes = Math.floor(divisor_for_minutes / 60);\r\n\r\n    let divisor_for_seconds = divisor_for_minutes % 60;\r\n    let seconds = Math.ceil(divisor_for_seconds);\r\n\r\n    let obj = {\r\n      \"h\": hours,\r\n      \"m\": minutes,\r\n      \"s\": seconds\r\n    };\r\n    return obj;\r\n  }\r\n\r\n  componentDidMount() {\r\n    let timeLeftVar = this.secondsToTime(this.state.seconds);\r\n    this.getUserData();\r\n    this.setState({ time: timeLeftVar });\r\n    this.startTimer();\r\n  }\r\n\r\n  startTimer() {\r\n\r\n    if (this.timer === 0 && this.state.seconds > 0) {\r\n      this.setState({\r\n        seconds: this.state.seconds,\r\n      });\r\n      this.timer = setInterval(this.countDown, 1000);\r\n    }\r\n  }\r\n\r\n  restartTimer() {\r\n    this.setState({\r\n      restart: true,\r\n    });\r\n  }\r\n\r\n  async getUserData() {\r\n    var user = db.onceGetUser(firebase.auth.currentUser.uid).then(snapshot => snapshot.val());\r\n    await user.then((value) => {\r\n      this.setState({\r\n        user: value\r\n      })\r\n    });\r\n    await this.setNewFoodTimer();\r\n\r\n    var userNew = db.onceGetUser(firebase.auth.currentUser.uid).then(snapshot => snapshot.val());\r\n    await userNew.then((value) => {\r\n      this.setState({\r\n        user: value\r\n      })\r\n    });\r\n    await this.setState({\r\n      seconds: this.state.user.timers[1].timer\r\n    })\r\n\r\n  }\r\n  async setNewFoodTimer() {\r\n    var timeStamp = Math.floor(Date.now() / 1000);\r\n    var newTimerFood = this.state.user.timers[1].timer;\r\n\r\n    var timestampFood = this.state.user.timers[1].timestamp;\r\n\r\n    var diffFood = timeStamp - timestampFood;\r\n\r\n    var newTimer = Math.max(newTimerFood - diffFood, 1);\r\n\r\n    await db.setTimer(firebase.auth.currentUser.uid, newTimer, 1, \"food\", Math.floor(Date.now() / 1000));\r\n  }\r\n\r\n  async setFoodTimer(seconds) {\r\n    await db.setTimer(firebase.auth.currentUser.uid, seconds, 1, \"food\", Math.floor(Date.now() / 1000));\r\n\r\n  }\r\n\r\n  countDown() {\r\n    if (this.props.restart) {\r\n      this.restartTimer();\r\n      //boom info back, zeby zmienic restart na false <---\r\n      this.props.pls();\r\n    }\r\n\r\n    if (!this.props.alive) {\r\n      console.log('pet died babe');\r\n      clearInterval(this.timer);\r\n      //this.props.petDied('hunger');\r\n    }\r\n\r\n    if (!this.state.restart) {\r\n      // Remove one second, set state so a re-render happens.\r\n      let seconds = this.state.seconds - 1;\r\n      this.setState({\r\n        time: this.secondsToTime(seconds),\r\n        seconds: seconds,\r\n      });\r\n      // Check if we're at zero.\r\n      if (seconds === 0) {\r\n        clearInterval(this.timer);\r\n        this.props.petDied('hunger');\r\n        //PET DEAD\r\n      }\r\n    }\r\n    else {\r\n      let seconds = 3599;\r\n      this.setState({\r\n        restart: false,\r\n        time: this.secondsToTime(seconds),\r\n        seconds: seconds,\r\n      });\r\n      this.setFoodTimer(seconds);\r\n    }\r\n  }\r\n\r\n  renderMinutesWithZero() {\r\n    return (\r\n      <div>\r\n        <h3 className=\"timer wash-timer\">\r\n          0{this.state.time.m}:{this.state.time.s}\r\n          {this.props.restart}\r\n        </h3>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderSecondsWithZero() {\r\n    return (\r\n      <div>\r\n        <h3 className=\"timer food-timer\">\r\n          {this.state.time.m}:0{this.state.time.s}\r\n          {this.props.restart}\r\n        </h3>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderBothWithZero() {\r\n    return (\r\n      <div>\r\n        <h3 className=\"timer food-timer\">\r\n          0{this.state.time.m}:0{this.state.time.s}\r\n          {this.props.restart}\r\n        </h3>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderNormalTimer() {\r\n    return (\r\n      <div>\r\n        {/*<button onClick={this.restartTimer}>Restart</button>*/}\r\n        <h3 className=\"timer food-timer\">\r\n          {this.state.time.m}:{this.state.time.s}\r\n          {this.props.restart}\r\n        </h3>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderOtherTimer() {\r\n    return (\r\n      <div>\r\n        {\r\n          (this.state.time.m < 10 && this.state.time.s > 9) ?\r\n            this.renderMinutesWithZero()\r\n            : this.renderOtherOtherTimer()\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderOtherOtherTimer() {\r\n    return (\r\n      <div>\r\n        {\r\n          (this.state.time.m > 9 && this.state.time.s < 10) ?\r\n            this.renderSecondsWithZero()\r\n            : this.renderNormalTimer()\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    if (this.state.time.h < 25) {\r\n      return (\r\n        <div>\r\n          {\r\n            (this.state.time.m < 10 && this.state.time.s < 10) ?\r\n              this.renderBothWithZero()\r\n              : this.renderOtherTimer()\r\n          }\r\n        </div>\r\n      );\r\n    }\r\n    else {\r\n      return null;\r\n    }\r\n\r\n  }\r\n}\r\n\r\nexport default FoodTimer;"]},"metadata":{},"sourceType":"module"}